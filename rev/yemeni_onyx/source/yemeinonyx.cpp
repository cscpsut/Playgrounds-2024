

#include <jni.h>
#include <string>
#include <vector>

extern "C"
JNIEXPORT jboolean JNICALL
Java_com_example_yemenionyx_MainActivity_checkInput(JNIEnv *env, jobject, jstring input) {
    const char *userInput = env->GetStringUTFChars(input, nullptr);
    std::string inputStr = userInput;
    env->ReleaseStringUTFChars(input, userInput);

    std::vector<uint8_t> correctArray = {
            0x81, 0xbd, 0xb0, 0xa8, 0xb6, 0xa3, 0xbe, 0xa4, 0xbf, 0xb5, 0xa2, 0x92,
            0x85, 0x97, 0xaa, 0x95, 0xe1, 0x8e, 0xa8, 0xe1, 0xa4, 0x8e, 0x9a, 0xbf,
            0xe1, 0xa6, 0x8e, 0xe6, 0xb9, 0xb0, 0xa5, 0x8e, 0xa8, 0xe1, 0xa4, 0x8e,
            0xb2, 0xe5, 0xbf, 0xa5, 0x8e, 0xb3, 0xa4, 0xa3, 0xbf, 0x8e, 0xa8, 0xe2,
            0xbc, 0xe2, 0xbf, 0xb8, 0x8e, 0xe1, 0x9f, 0x88, 0x89, 0xac
    };

    if (inputStr.length() != correctArray.size()) {
        return JNI_FALSE;
    }

    for (size_t i = 0; i < inputStr.length(); ++i) {
        if ((inputStr[i] ^ 0xD1) != correctArray[i]) {
            return JNI_FALSE;
        }
    }

    return JNI_TRUE;
}
